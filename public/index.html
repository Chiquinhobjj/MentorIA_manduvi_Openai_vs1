<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mentores Manduvi</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="app">
    <nav class="sidebar">
      <div class="sidebar-header">
        <div class="brand">
          <div class="avatar">üåø</div>
          <div>
            <div class="title">Mentores Manduvi</div>
            <div class="subtitle">Trilhas profissionais</div>
          </div>
        </div>
        <div class="sidebar-progress">
          <div class="meta">Meta certifica√ß√£o</div>
          <div class="xp-line">
            <span id="sidebar-xp">0</span>
            <span class="goal">/ 300 XP</span>
          </div>
        </div>
      </div>
      <div class="nav-menu">
        <a href="#home" class="nav-item" data-section="home">
          <span class="icon">üéØ</span>
          <span class="label">Tutores</span>
        </a>
        <a href="#chat" class="nav-item active" data-section="chat">
          <span class="icon">üí¨</span>
          <span class="label">Estudar &amp; Praticar</span>
        </a>
        <a href="#missions" class="nav-item" data-section="missions">
          <span class="icon">üìà</span>
          <span class="label">Miss√µes &amp; XP</span>
        </a>
        <a href="#profile" class="nav-item" data-section="profile">
          <span class="icon">üß≠</span>
          <span class="label">Perfil</span>
        </a>
        <a href="#admin" class="nav-item" data-section="admin">
          <span class="icon">üõ†Ô∏è</span>
          <span class="label">Admin</span>
        </a>
      </div>
    </nav>

    <main class="main-content">
      <section id="home-section" class="content-section">
        <header class="section-header">
          <h1>Escolha seu Tutor</h1>
          <p class="section-subtitle">Selecione a persona que guia sua trilha Manduvi e acompanhe metas de certifica√ß√£o.</p>
        </header>
        <div class="tutor-grid">
          <article class="tutor-card" data-agent="tutor">
            <div class="tutor-head">
              <div class="persona">üíª</div>
              <div>
                <h2>Tutor Tech Frontend</h2>
                <p>HTML, CSS, JS e projetos guiados.</p>
              </div>
            </div>
            <ul class="competencies">
              <li>Componentes responsivos</li>
              <li>Boas pr√°ticas de UI</li>
              <li>Projetos semanais</li>
            </ul>
            <button class="primary" data-select-agent="tutor">Usar este tutor</button>
          </article>
          <article class="tutor-card" data-agent="planner">
            <div class="tutor-head">
              <div class="persona">ü§ù</div>
              <div>
                <h2>Tutor Atendimento &amp; Vendas</h2>
                <p>Scripts, obje√ß√µes e simula√ß√µes.</p>
              </div>
            </div>
            <ul class="competencies">
              <li>Pitch em 3 passos</li>
              <li>Negocia√ß√£o e rapport</li>
              <li>Simula√ß√µes por WhatsApp</li>
            </ul>
            <button class="primary" data-select-agent="planner">Usar este tutor</button>
          </article>
          <article class="tutor-card" data-agent="helper">
            <div class="tutor-head">
              <div class="persona">ü©∫</div>
              <div>
                <h2>Tutor Sa√∫de Comunit√°ria</h2>
                <p>Protocolos SUS e casos pr√°ticos.</p>
              </div>
            </div>
            <ul class="competencies">
              <li>Classifica√ß√£o de risco</li>
              <li>Checklists de atendimento</li>
              <li>Encaminhamentos seguros</li>
            </ul>
            <button class="primary" data-select-agent="helper">Usar este tutor</button>
          </article>
        </div>
      </section>

      <section id="chat-section" class="content-section active">
        <header class="section-header">
          <div>
            <h1>Estudar &amp; Praticar</h1>
            <p class="section-subtitle">Diagnosticar ‚Üí Ensinar ‚Üí Testar ‚Üí Feedback ‚Üí Refor√ßo com XP.</p>
          </div>
          <div class="agent-picker">
            <label for="agent">Tutor ativo:</label>
            <select id="agent">
              <option value="tutor" selected>Tutor Tech Frontend</option>
              <option value="planner">Tutor Atendimento &amp; Vendas</option>
              <option value="helper">Tutor Sa√∫de Comunit√°ria</option>
            </select>
          </div>
        </header>

        <div class="learning-header">
          <div class="progress-card">
            <div class="goal">Meta de certifica√ß√£o: <span id="xp-goal-top">300 XP</span></div>
            <div class="xp-bar">
              <div class="xp-fill" id="xp-fill"></div>
            </div>
            <div class="xp-stats"><span id="xp-current">0</span> XP ‚Ä¢ N√≠vel <span id="xp-level">0</span> (<span id="xp-label">Diagn√≥stico</span>)</div>
            <div class="badges-strip" id="badge-strip"></div>
          </div>
          <div class="quick-actions">
            <button id="practice-btn" class="primary">Praticar agora</button>
            <button id="review-btn" class="ghost">Revisar</button>
          </div>
        </div>

        <div class="chat-container">
          <div id="messages" class="messages"></div>
          <div class="chat-footer">
            <div class="quick-replies">
              <button data-text="Quero meu diagn√≥stico inicial">Diagn√≥stico</button>
              <button data-text="Me ensine um t√≥pico com exemplo">Ensinar</button>
              <button data-text="Praticar agora">Praticar</button>
            </div>
            <form id="form" class="composer">
              <input id="input" type="text" placeholder="Escreva sua mensagem..." autocomplete="off" />
              <button id="send" type="submit">Enviar</button>
            </form>
          </div>
        </div>
      </section>

      <section id="missions-section" class="content-section">
        <header class="section-header">
          <div>
            <h1>Miss√µes &amp; XP</h1>
            <p class="section-subtitle">Veja desafios em andamento, hist√≥rico de XP e pr√≥ximos passos.</p>
          </div>
        </header>
        <div class="missions-grid">
          <div class="missions-card">
            <h2>Pr√≥ximas miss√µes</h2>
            <ul id="mission-list" class="mission-list"></ul>
          </div>
          <div class="missions-card">
            <h2>Hist√≥rico de XP</h2>
            <div id="xp-history" class="xp-history"></div>
          </div>
        </div>
      </section>

      <section id="profile-section" class="content-section">
        <header class="section-header">
          <div>
            <h1>Perfil do Aprendiz</h1>
            <p class="section-subtitle">Resumo do progresso, badges e lacunas para seu pr√≥ximo passo.</p>
          </div>
        </header>
        <div class="profile-grid">
          <div class="profile-card">
            <h2>Status</h2>
            <p><strong>XP total:</strong> <span id="profile-xp">0</span> / <span id="profile-goal">300</span></p>
            <p><strong>N√≠vel atual:</strong> <span id="profile-level">0</span> ‚Äî <span id="profile-label">Diagn√≥stico</span></p>
            <p><strong>XP para pr√≥ximo n√≠vel:</strong> <span id="profile-next">50</span></p>
            <div>
              <h3>Badges</h3>
              <ul id="profile-badges" class="badge-list"></ul>
            </div>
          </div>
          <div class="profile-card">
            <h2>Lacunas detectadas</h2>
            <ul id="profile-gaps" class="gap-list"></ul>
          </div>
        </div>
      </section>

      <section id="admin-section" class="content-section">
        <header class="section-header">
          <div>
            <h1>Admin &amp; Conte√∫do</h1>
            <p class="section-subtitle">Gerencie chave da API, ingest√£o de conte√∫do e configura√ß√µes dos tutores.</p>
          </div>
        </header>
        <div class="admin-grid">
          <div class="config-card">
            <h2>API Key</h2>
            <p>Status: <span id="api-status">Verificando...</span></p>
            <div class="api-row">
              <input id="api-key-input" type="password" placeholder="Cole sua OPENAI_API_KEY" />
              <label class="persist">
                <input id="persist-key" type="checkbox" />
                Persistir (.env)
              </label>
            </div>
            <div class="button-row">
              <button onclick="saveAPIKey()" class="primary">Salvar chave</button>
              <button onclick="checkAPI()" class="ghost">Verificar</button>
            </div>
          </div>
          <div class="config-card">
            <h2>Reindexar acervo</h2>
            <p>Envie PDFs/MD/TXT para <code>src/backend/rag/data</code> e clique abaixo para reprocessar.</p>
            <button onclick="runIngest()" class="ghost">Executar ingest√£o</button>
          </div>
        </div>

        <div class="admin-grid">
          <div class="config-card">
            <h2>RAG - Busca r√°pida</h2>
            <div class="rag-search">
              <input type="text" id="rag-query" placeholder="Buscar no acervo..." />
              <button onclick="searchRAG()" class="primary">Buscar</button>
            </div>
            <div id="rag-results" class="rag-results"></div>
          </div>
          <div class="config-card">
            <h2>Configura√ß√£o de agentes</h2>
            <div class="agent-config">
              <div class="config-row">
                <label>Agente:</label>
                <select id="config-agent-select">
                  <option value="tutor">Tutor</option>
                  <option value="planner">Planner</option>
                  <option value="helper">Helper</option>
                </select>
                <button onclick="loadAgentConfig()" class="ghost">Carregar</button>
              </div>
              <div class="config-row">
                <label>Nome:</label>
                <input type="text" id="config-name" />
              </div>
              <div class="config-row">
                <label>Modelo:</label>
                <input type="text" id="config-model" />
              </div>
              <div class="config-row">
                <label>Temperatura:</label>
                <input type="range" id="config-temperature" min="0" max="2" step="0.1" value="0.7" />
                <span id="temp-value">0.7</span>
              </div>
              <div class="config-row">
                <label>Max tokens:</label>
                <input type="number" id="config-max-tokens" min="100" max="4000" value="2000" />
              </div>
              <div class="config-row">
                <label>Embedding:</label>
                <input type="text" id="config-embed-model" />
              </div>
              <div class="config-row">
                <label>Top-K:</label>
                <input type="number" id="config-rag-k" min="1" max="20" value="6" />
              </div>
              <div class="config-row">
                <label>Chunk:</label>
                <input type="number" id="config-chunk-size" min="100" max="2000" value="800" />
              </div>
              <div class="config-row">
                <label>Overlap:</label>
                <input type="number" id="config-overlap" min="0" max="500" value="150" />
              </div>
              <div class="config-row checkbox">
                <label>Ferramentas ativas</label>
                <input type="checkbox" id="config-tools-enabled" />
              </div>
              <div class="config-row">
                <label>Prompt do sistema</label>
                <textarea id="config-system-prompt" rows="6"></textarea>
              </div>
              <div class="button-row">
                <button onclick="saveAgentConfig()" class="primary">Salvar</button>
                <button onclick="resetAgentConfig()" class="ghost">Resetar</button>
              </div>
            </div>
          </div>
        </div>

        <div class="health-grid">
          <div class="health-card">
            <h3>Servidor</h3>
            <p id="server-status">Verificando...</p>
          </div>
          <div class="health-card">
            <h3>Embeddings</h3>
            <p id="embed-status">Verificando...</p>
          </div>
          <div class="health-card">
            <h3>RAG Index</h3>
            <p id="rag-status">Verificando...</p>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="/main.js"></script>
</body>
</html>
